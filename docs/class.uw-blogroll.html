<!DOCTYPE html>

<html>
<head>
  <title>class.uw-blogroll.php</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="404.html">
                404.php
              </a>
            
              
              <a class="source" href="application.html">
                application.php
              </a>
            
              
              <a class="source" href="archive.html">
                archive.php
              </a>
            
              
              <a class="source" href="breadcrumbs.html">
                breadcrumbs.php
              </a>
            
              
              <a class="source" href="comments.html">
                comments.php
              </a>
            
              
              <a class="source" href="content-archive.html">
                content-archive.php
              </a>
            
              
              <a class="source" href="content-image.html">
                content-image.php
              </a>
            
              
              <a class="source" href="content-page.html">
                content-page.php
              </a>
            
              
              <a class="source" href="content-pdf.html">
                content-pdf.php
              </a>
            
              
              <a class="source" href="content.html">
                content.php
              </a>
            
              
              <a class="source" href="footer.html">
                footer.php
              </a>
            
              
              <a class="source" href="functions.html">
                functions.php
              </a>
            
              
              <a class="source" href="header-image.html">
                header-image.php
              </a>
            
              
              <a class="source" href="header.html">
                header.php
              </a>
            
              
              <a class="source" href="image.html">
                image.php
              </a>
            
              
              <a class="source" href="template-functions.html">
                template-functions.php
              </a>
            
              
              <a class="source" href="index.html">
                index.php
              </a>
            
              
              <a class="source" href="uw.html">
                uw.js
              </a>
            
              
              <a class="source" href="menu-mobile.html">
                menu-mobile.php
              </a>
            
              
              <a class="source" href="page.html">
                page.php
              </a>
            
              
              <a class="source" href="search.html">
                search.php
              </a>
            
              
              <a class="source" href="searchform.html">
                searchform.php
              </a>
            
              
              <a class="source" href="class.button-shortcode.html">
                class.button-shortcode.php
              </a>
            
              
              <a class="source" href="class.dropdowns_walker.html">
                class.dropdowns_walker.php
              </a>
            
              
              <a class="source" href="class.filters.html">
                class.filters.php
              </a>
            
              
              <a class="source" href="class.googleapps.html">
                class.googleapps.php
              </a>
            
              
              <a class="source" href="class.images.html">
                class.images.php
              </a>
            
              
              <a class="source" href="class.install.html">
                class.install.php
              </a>
            
              
              <a class="source" href="class.mimes.html">
                class.mimes.php
              </a>
            
              
              <a class="source" href="class.squish_bugs.html">
                class.squish_bugs.php
              </a>
            
              
              <a class="source" href="class.tile-box-shortcode.html">
                class.tile-box-shortcode.php
              </a>
            
              
              <a class="source" href="class.trumba-shortcode.html">
                class.trumba-shortcode.php
              </a>
            
              
              <a class="source" href="class.users.html">
                class.users.php
              </a>
            
              
              <a class="source" href="class.uw-carousel.html">
                class.uw-carousel.php
              </a>
            
              
              <a class="source" href="class.uw-directory.html">
                class.uw-directory.php
              </a>
            
              
              <a class="source" href="class.uw-documentation.html">
                class.uw-documentation.php
              </a>
            
              
              <a class="source" href="class.uw-dropdowns.html">
                class.uw-dropdowns.php
              </a>
            
              
              <a class="source" href="class.uw-enclosure.html">
                class.uw-enclosure.php
              </a>
            
              
              <a class="source" href="class.uw-iframes.html">
                class.uw-iframes.php
              </a>
            
              
              <a class="source" href="class.uw-media-caption.html">
                class.uw-media-caption.php
              </a>
            
              
              <a class="source" href="class.uw-media-credit.html">
                class.uw-media-credit.php
              </a>
            
              
              <a class="source" href="class.uw-oembeds.html">
                class.uw-oembeds.php
              </a>
            
              
              <a class="source" href="class.uw-page-attributes-meta-box.html">
                class.uw-page-attributes-meta-box.php
              </a>
            
              
              <a class="source" href="class.uw-quicklinks.html">
                class.uw-quicklinks.php
              </a>
            
              
              <a class="source" href="class.uw-replace-media.html">
                class.uw-replace-media.php
              </a>
            
              
              <a class="source" href="class.uw-scripts.html">
                class.uw-scripts.php
              </a>
            
              
              <a class="source" href="class.uw-shortcodes.html">
                class.uw-shortcodes.php
              </a>
            
              
              <a class="source" href="class.uw-styles.html">
                class.uw-styles.php
              </a>
            
              
              <a class="source" href="class.uw-tinymce.html">
                class.uw-tinymce.php
              </a>
            
              
              <a class="source" href="class.uw.html">
                class.uw.php
              </a>
            
              
              <a class="source" href="class.youtube-shortcode.html">
                class.youtube-shortcode.php
              </a>
            
              
              <a class="source" href="sidebar.html">
                sidebar.php
              </a>
            
              
              <a class="source" href="template-big-hero.html">
                template-big-hero.php
              </a>
            
              
              <a class="source" href="template-no-hero.html">
                template-no-hero.php
              </a>
            
              
              <a class="source" href="template-no-sidebar.html">
                template-no-sidebar.php
              </a>
            
              
              <a class="source" href="template-no-title.html">
                template-no-title.php
              </a>
            
              
              <a class="source" href="template-small-hero.html">
                template-small-hero.php
              </a>
            
              
              <a class="source" href="thinstrip.html">
                thinstrip.php
              </a>
            
              
              <a class="source" href="class.uw-blogroll.html">
                class.uw-blogroll.php
              </a>
            
              
              <a class="source" href="class.uw-campus-map.html">
                class.uw-campus-map.php
              </a>
            
              
              <a class="source" href="class.uw-intro.html">
                class.uw-intro.php
              </a>
            
              
              <a class="source" href="class.uw-recent-posts.html">
                class.uw-recent-posts.php
              </a>
            
              
              <a class="source" href="class.uw-related-posts.html">
                class.uw-related-posts.php
              </a>
            
              
              <a class="source" href="class.uw-rss.html">
                class.uw-rss.php
              </a>
            
              
              <a class="source" href="class.uw-sidebar.html">
                class.uw-sidebar.php
              </a>
            
              
              <a class="source" href="class.uw-single-image.html">
                class.uw-single-image.php
              </a>
            
              
              <a class="source" href="class.uw-top-posts.html">
                class.uw-top-posts.php
              </a>
            
              
              <a class="source" href="class.uw-twitter.html">
                class.uw-twitter.php
              </a>
            
              
              <a class="source" href="class.uw-widget-visibility.html">
                class.uw-widget-visibility.php
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>class.uw-blogroll.php</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>&lt;?php

class UW_Blogroll extends WP_Widget
{

  const NAME        = 'Blogroll';
  const ID          = 'blogroll';
  const CLASSNAME   = 'uw-blogroll';
  const DESCRIPTION = 'Pull and display your sites blog posts';
  const LIMIT       = 2;

  function __construct()
  {

    parent::WP_Widget( self::ID , __( self::NAME ), array(
      'classname' =&gt; self::CLASSNAME,
      'description' =&gt; __( self::DESCRIPTION )
    ));

    add_shortcode( self::ID , array( $this, 'shortcode' ) );

  }

  function form( $instance )
  {
    $title  = empty( $instance['title'] ) ? self::NAME : esc_attr( $instance['title'] );
    $number = empty( $instance['number'] ) ? 2 : absint( $instance['number'] );
    ?&gt;
      &lt;p&gt;
        &lt;label for="&lt;?php echo esc_attr( $this-&gt;get_field_id( 'title' ) ); ?&gt;"&gt;&lt;?php _e( 'Title:', 'twentyfourteen' ); ?&gt;&lt;/label&gt;
        &lt;input id="&lt;?php echo esc_attr( $this-&gt;get_field_id( 'title' ) ); ?&gt;" class="widefat" name="&lt;?php echo esc_attr( $this-&gt;get_field_name( 'title' ) ); ?&gt;" type="text" value="&lt;?php echo esc_attr( $title ); ?&gt;"&gt;
      &lt;/p&gt;

      &lt;p&gt;
        &lt;label for="&lt;?php echo esc_attr( $this-&gt;get_field_id( 'number' ) ); ?&gt;"&gt;&lt;?php _e( 'Number of posts to show:', 'twentyfourteen' ); ?&gt;&lt;/label&gt;
        &lt;input id="&lt;?php echo esc_attr( $this-&gt;get_field_id( 'number' ) ); ?&gt;" name="&lt;?php echo esc_attr( $this-&gt;get_field_name( 'number' ) ); ?&gt;" type="text" value="&lt;?php echo esc_attr( $number ); ?&gt;" size="3"&gt;
      &lt;/p&gt;

    &lt;?php
  }

  function update( $new_instance, $instance )
  {
		$instance['title']  = strip_tags( $new_instance['title'] );
		$instance['number'] = empty( $new_instance['number'] ) ? self::LIMIT : absint( $new_instance['number'] );
		return $instance;
  }

  function widget( $args, $instance )
  {
    extract( $args );
    extract( $instance );

    $title  = apply_filters( 'widget_title', $title );

    echo $args['before_widget'];
    echo '&lt;h2&gt;' . $title .'&lt;/h2&gt;';

    echo do_shortcode( "[".self::ID." number={$number}/]");

    echo $args['after_widget'];
  }

  function shortcode( $atts )
  {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>todo: consider renaming these to match the get_post variables</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-variable">$params</span> = shortcode_atts( <span class="hljs-keyword">array</span>(
          <span class="hljs-string">'excerpt'</span>   =&gt; <span class="hljs-string">'true'</span>,
          <span class="hljs-string">'trim'</span>      =&gt; <span class="hljs-string">'false'</span>,
          <span class="hljs-string">'image'</span>     =&gt; <span class="hljs-string">'hide'</span>,
          <span class="hljs-string">'author'</span>    =&gt; <span class="hljs-string">'show'</span>,
          <span class="hljs-string">'titletag'</span>  =&gt; <span class="hljs-string">'h2'</span>,
          <span class="hljs-string">'post_type'</span> =&gt;  <span class="hljs-string">'post'</span>,
          <span class="hljs-string">'number'</span>    =&gt;  <span class="hljs-number">5</span>,
          <span class="hljs-string">'mini'</span>    =&gt;  <span class="hljs-keyword">false</span>
      ), <span class="hljs-variable">$atts</span> );

    <span class="hljs-keyword">if</span> ( !array_key_exists(<span class="hljs-string">'numberposts'</span>, <span class="hljs-variable">$params</span> ) )
      <span class="hljs-variable">$params</span>[<span class="hljs-string">'numberposts'</span>] = <span class="hljs-variable">$params</span>[<span class="hljs-string">'number'</span>];

    <span class="hljs-variable">$posts</span> = get_posts( <span class="hljs-variable">$params</span> );

    <span class="hljs-variable">$params</span> = (object) <span class="hljs-variable">$params</span>;
    <span class="hljs-variable">$mini</span> = <span class="hljs-variable">$params</span><span class="hljs-variable">-&gt;mini</span>;
    <span class="hljs-variable">$html</span> = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">foreach</span> ( <span class="hljs-variable">$posts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$post</span> ) {

      <span class="hljs-variable">$link</span> = get_permalink( <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;ID</span> );

      <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;is_true</span>( <span class="hljs-variable">$params</span><span class="hljs-variable">-&gt;excerpt</span> ) )
      {

          <span class="hljs-variable">$excerpt</span> = has_excerpt( <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;ID</span> ) ? <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;post_excerpt</span> : apply_filters(<span class="hljs-string">'widget_text'</span>, <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;post_content</span>);

           <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;is_true</span>( <span class="hljs-variable">$params</span><span class="hljs-variable">-&gt;trim</span> ) )
              <span class="hljs-variable">$excerpt</span> = wp_trim_words( <span class="hljs-variable">$excerpt</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>using apply_filters(‘the_content’, $excerpt) causes an infinite loop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-variable">$excerpt</span> = wpautop( <span class="hljs-variable">$excerpt</span> );
      }

      <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;is_true</span>( <span class="hljs-variable">$params</span><span class="hljs-variable">-&gt;image</span> ) )
      {
          <span class="hljs-variable">$image</span> = get_the_post_thumbnail( <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;ID</span> , <span class="hljs-string">'thumbnail'</span> );
          <span class="hljs-variable">$class</span> = <span class="hljs-string">' class="pull-left"'</span>;
      }

      <span class="hljs-variable">$author</span> = <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;is_true</span>( <span class="hljs-variable">$params</span><span class="hljs-variable">-&gt;author</span> ) ? <span class="hljs-string">'&lt;p class="author-info"&gt;'</span> . get_the_author_meta( <span class="hljs-string">'display_name'</span>, <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;post_author</span> ) . <span class="hljs-string">'&lt;/p&gt;'</span> : <span class="hljs-string">''</span>;
      <span class="hljs-variable">$author_mini</span> = <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;is_true</span>( <span class="hljs-variable">$params</span><span class="hljs-variable">-&gt;author</span> ) ? get_the_author_meta( <span class="hljs-string">'display_name'</span>, <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;post_author</span> ) : <span class="hljs-string">''</span>;

      <span class="hljs-variable">$date</span>   = get_the_time( get_option( <span class="hljs-string">'date_format'</span> ), <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;ID</span> );

      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$mini</span>){
        <span class="hljs-variable">$html</span> .= sprintf(<span class="hljs-string">"&lt;li&gt;&lt;a class='widget-thumbnail' href='%s'&gt;%s&lt;/a&gt;&lt;a class='widget-link' href='%s'&gt;%s&lt;span&gt;&lt;small&gt;%s | %s&lt;/small&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;"</span>, <span class="hljs-variable">$link</span>, <span class="hljs-variable">$image</span>, <span class="hljs-variable">$link</span>, <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;post_title</span>, <span class="hljs-variable">$author_mini</span>, <span class="hljs-variable">$date</span>);
      }
      <span class="hljs-keyword">else</span> {
        <span class="hljs-variable">$html</span>  .= <span class="hljs-string">"&lt;li$class&gt;&lt;span&gt;&lt;{$params-&gt;titletag}&gt;&lt;a href=\"$link\"&gt;{$post-&gt;post_title}&lt;/a&gt;&lt;p class=\"date\"&gt;{$date}&lt;/p&gt;&lt;/{$params-&gt;titletag}&gt;{$author}{$excerpt}&lt;/span&gt;&lt;/li&gt;"</span>;
      }

    }

    <span class="hljs-variable">$miniclass</span> = <span class="hljs-variable">$mini</span> ? <span class="hljs-string">'-mini'</span> : <span class="hljs-string">''</span>;
    <span class="hljs-variable">$html</span> = <span class="hljs-string">"&lt;ul class=\"shortcode-blogroll$miniclass\"&gt;$html&lt;/ul&gt;"</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$html</span>;

  }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>consider normalizing the show/hides and true/falses</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_true</span><span class="hljs-params">( <span class="hljs-variable">$attribute</span> )</span>
  </span>{
    <span class="hljs-keyword">return</span> in_array( <span class="hljs-variable">$attribute</span> , <span class="hljs-keyword">array</span>( <span class="hljs-string">'show'</span>, <span class="hljs-string">'true'</span> ) );
  }

}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>new UW_Blogroll;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
register_widget( <span class="hljs-string">'UW_Blogroll'</span> );</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
