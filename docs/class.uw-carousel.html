<!DOCTYPE html>

<html>
<head>
  <title>class.uw-carousel.php</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="404.html">
                404.php
              </a>
            
              
              <a class="source" href="application.html">
                application.php
              </a>
            
              
              <a class="source" href="archive.html">
                archive.php
              </a>
            
              
              <a class="source" href="breadcrumbs.html">
                breadcrumbs.php
              </a>
            
              
              <a class="source" href="comments.html">
                comments.php
              </a>
            
              
              <a class="source" href="content-archive.html">
                content-archive.php
              </a>
            
              
              <a class="source" href="content-image.html">
                content-image.php
              </a>
            
              
              <a class="source" href="content-page.html">
                content-page.php
              </a>
            
              
              <a class="source" href="content-pdf.html">
                content-pdf.php
              </a>
            
              
              <a class="source" href="content.html">
                content.php
              </a>
            
              
              <a class="source" href="footer.html">
                footer.php
              </a>
            
              
              <a class="source" href="functions.html">
                functions.php
              </a>
            
              
              <a class="source" href="header-image.html">
                header-image.php
              </a>
            
              
              <a class="source" href="header.html">
                header.php
              </a>
            
              
              <a class="source" href="image.html">
                image.php
              </a>
            
              
              <a class="source" href="template-functions.html">
                template-functions.php
              </a>
            
              
              <a class="source" href="index.html">
                index.php
              </a>
            
              
              <a class="source" href="uw.html">
                uw.js
              </a>
            
              
              <a class="source" href="menu-mobile.html">
                menu-mobile.php
              </a>
            
              
              <a class="source" href="page.html">
                page.php
              </a>
            
              
              <a class="source" href="search.html">
                search.php
              </a>
            
              
              <a class="source" href="searchform.html">
                searchform.php
              </a>
            
              
              <a class="source" href="class.button-shortcode.html">
                class.button-shortcode.php
              </a>
            
              
              <a class="source" href="class.dropdowns_walker.html">
                class.dropdowns_walker.php
              </a>
            
              
              <a class="source" href="class.filters.html">
                class.filters.php
              </a>
            
              
              <a class="source" href="class.googleapps.html">
                class.googleapps.php
              </a>
            
              
              <a class="source" href="class.images.html">
                class.images.php
              </a>
            
              
              <a class="source" href="class.install.html">
                class.install.php
              </a>
            
              
              <a class="source" href="class.mimes.html">
                class.mimes.php
              </a>
            
              
              <a class="source" href="class.squish_bugs.html">
                class.squish_bugs.php
              </a>
            
              
              <a class="source" href="class.tile-box-shortcode.html">
                class.tile-box-shortcode.php
              </a>
            
              
              <a class="source" href="class.trumba-shortcode.html">
                class.trumba-shortcode.php
              </a>
            
              
              <a class="source" href="class.users.html">
                class.users.php
              </a>
            
              
              <a class="source" href="class.uw-carousel.html">
                class.uw-carousel.php
              </a>
            
              
              <a class="source" href="class.uw-directory.html">
                class.uw-directory.php
              </a>
            
              
              <a class="source" href="class.uw-documentation.html">
                class.uw-documentation.php
              </a>
            
              
              <a class="source" href="class.uw-dropdowns.html">
                class.uw-dropdowns.php
              </a>
            
              
              <a class="source" href="class.uw-enclosure.html">
                class.uw-enclosure.php
              </a>
            
              
              <a class="source" href="class.uw-iframes.html">
                class.uw-iframes.php
              </a>
            
              
              <a class="source" href="class.uw-media-caption.html">
                class.uw-media-caption.php
              </a>
            
              
              <a class="source" href="class.uw-media-credit.html">
                class.uw-media-credit.php
              </a>
            
              
              <a class="source" href="class.uw-oembeds.html">
                class.uw-oembeds.php
              </a>
            
              
              <a class="source" href="class.uw-page-attributes-meta-box.html">
                class.uw-page-attributes-meta-box.php
              </a>
            
              
              <a class="source" href="class.uw-quicklinks.html">
                class.uw-quicklinks.php
              </a>
            
              
              <a class="source" href="class.uw-replace-media.html">
                class.uw-replace-media.php
              </a>
            
              
              <a class="source" href="class.uw-scripts.html">
                class.uw-scripts.php
              </a>
            
              
              <a class="source" href="class.uw-shortcodes.html">
                class.uw-shortcodes.php
              </a>
            
              
              <a class="source" href="class.uw-styles.html">
                class.uw-styles.php
              </a>
            
              
              <a class="source" href="class.uw-tinymce.html">
                class.uw-tinymce.php
              </a>
            
              
              <a class="source" href="class.uw.html">
                class.uw.php
              </a>
            
              
              <a class="source" href="class.youtube-shortcode.html">
                class.youtube-shortcode.php
              </a>
            
              
              <a class="source" href="sidebar.html">
                sidebar.php
              </a>
            
              
              <a class="source" href="template-big-hero.html">
                template-big-hero.php
              </a>
            
              
              <a class="source" href="template-no-hero.html">
                template-no-hero.php
              </a>
            
              
              <a class="source" href="template-no-sidebar.html">
                template-no-sidebar.php
              </a>
            
              
              <a class="source" href="template-no-title.html">
                template-no-title.php
              </a>
            
              
              <a class="source" href="template-small-hero.html">
                template-small-hero.php
              </a>
            
              
              <a class="source" href="thinstrip.html">
                thinstrip.php
              </a>
            
              
              <a class="source" href="class.uw-blogroll.html">
                class.uw-blogroll.php
              </a>
            
              
              <a class="source" href="class.uw-campus-map.html">
                class.uw-campus-map.php
              </a>
            
              
              <a class="source" href="class.uw-intro.html">
                class.uw-intro.php
              </a>
            
              
              <a class="source" href="class.uw-recent-posts.html">
                class.uw-recent-posts.php
              </a>
            
              
              <a class="source" href="class.uw-related-posts.html">
                class.uw-related-posts.php
              </a>
            
              
              <a class="source" href="class.uw-rss.html">
                class.uw-rss.php
              </a>
            
              
              <a class="source" href="class.uw-sidebar.html">
                class.uw-sidebar.php
              </a>
            
              
              <a class="source" href="class.uw-single-image.html">
                class.uw-single-image.php
              </a>
            
              
              <a class="source" href="class.uw-top-posts.html">
                class.uw-top-posts.php
              </a>
            
              
              <a class="source" href="class.uw-twitter.html">
                class.uw-twitter.php
              </a>
            
              
              <a class="source" href="class.uw-widget-visibility.html">
                class.uw-widget-visibility.php
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>class.uw-carousel.php</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-comment">/*
Plugin Name: UW Carousel
Plugin URL: http://uw.edu
Description: Transform your standard image galleries into an immersive full-screen experience.
Version: 0.1
Author: Automattic

Released under the GPL v.2 license.

This is a fork of the Jetpack Carousel plugni

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
*/</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UW_Carousel</span> </span>{

  <span class="hljs-keyword">const</span> COLUMNS = <span class="hljs-number">5</span>;
  <span class="hljs-keyword">const</span> LINK         = <span class="hljs-string">'none'</span>;

  <span class="hljs-keyword">var</span> <span class="hljs-variable">$prebuilt_widths</span> = <span class="hljs-keyword">array</span>( <span class="hljs-number">370</span>, <span class="hljs-number">700</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">1200</span>, <span class="hljs-number">1400</span>, <span class="hljs-number">2000</span> );

  <span class="hljs-keyword">var</span> <span class="hljs-variable">$first_run</span> = <span class="hljs-keyword">true</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span>
  </span>{
    add_action( <span class="hljs-string">'init'</span>, <span class="hljs-keyword">array</span>( <span class="hljs-variable">$this</span>, <span class="hljs-string">'init'</span> ) );
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span><span class="hljs-params">()</span>
  </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Disable filter for child themes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;disable</span>() )
      <span class="hljs-keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>If on front-end, do the Carousel thang.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;prebuilt_widths</span> = apply_filters( <span class="hljs-string">'jp_carousel_widths'</span>, <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;prebuilt_widths</span> );
    add_action( <span class="hljs-string">'wp_enqueue_scripts'</span>, <span class="hljs-keyword">array</span>( <span class="hljs-variable">$this</span>, <span class="hljs-string">'enqueue_assets'</span> ) ); <span class="hljs-comment">// load later than other callbacks hooked it</span>
    add_filter( <span class="hljs-string">'gallery_style'</span>, <span class="hljs-keyword">array</span>( <span class="hljs-variable">$this</span>, <span class="hljs-string">'add_data_to_container'</span> ) );
    add_filter( <span class="hljs-string">'wp_get_attachment_image_attributes'</span>, <span class="hljs-keyword">array</span>( <span class="hljs-variable">$this</span>, <span class="hljs-string">'add_data_to_images'</span> ), <span class="hljs-number">10</span>, <span class="hljs-number">2</span> );
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable</span><span class="hljs-params">()</span>
  </span>{
    <span class="hljs-keyword">return</span> apply_filters( <span class="hljs-string">'uw_carousel_disable'</span>, <span class="hljs-keyword">false</span> );
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asset_version</span><span class="hljs-params">( <span class="hljs-variable">$version</span> )</span> </span>{
    <span class="hljs-keyword">return</span> apply_filters( <span class="hljs-string">'jp_carousel_asset_version'</span>, <span class="hljs-variable">$version</span> );
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enqueue_assets</span><span class="hljs-params">( <span class="hljs-variable">$output</span> )</span> </span>{

    <span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">empty</span>( <span class="hljs-variable">$output</span> ) &amp;&amp; ! apply_filters( <span class="hljs-string">'jp_carousel_force_enable'</span>, <span class="hljs-keyword">false</span> ) )
    {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Bail because someone is overriding the [gallery] shortcode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      remove_filter( <span class="hljs-string">'gallery_style'</span>, <span class="hljs-keyword">array</span>( <span class="hljs-variable">$this</span>, <span class="hljs-string">'add_data_to_container'</span> ) );
      remove_filter( <span class="hljs-string">'wp_get_attachment_image_attributes'</span>, <span class="hljs-keyword">array</span>( <span class="hljs-variable">$this</span>, <span class="hljs-string">'add_data_to_images'</span> ) );
      <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;
    }

    do_action( <span class="hljs-string">'jp_carousel_thumbnails_shown'</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Note: using  home_url() instead of admin_url() for ajaxurl to be sure  to get same domain on wpcom when using mapped domains (also works on self-hosted)
Also: not hardcoding path since there is no guarantee site is running on site root in self-hosted context.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-variable">$is_logged_in</span> = is_user_logged_in();
    <span class="hljs-variable">$current_user</span> = wp_get_current_user();
    <span class="hljs-variable">$comment_registration</span> = intval( get_option( <span class="hljs-string">'comment_registration'</span> ) );
    <span class="hljs-variable">$require_name_email</span>   = intval( get_option( <span class="hljs-string">'require_name_email'</span> ) );
    <span class="hljs-variable">$localize_strings</span> = <span class="hljs-keyword">array</span>(
      <span class="hljs-string">'widths'</span>               =&gt; <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;prebuilt_widths</span>,
      <span class="hljs-string">'is_logged_in'</span>         =&gt; <span class="hljs-variable">$is_logged_in</span>,
      <span class="hljs-string">'lang'</span>                 =&gt; strtolower( substr( get_locale(), <span class="hljs-number">0</span>, <span class="hljs-number">2</span> ) ),
      <span class="hljs-string">'ajaxurl'</span>              =&gt; set_url_scheme( admin_url( <span class="hljs-string">'admin-ajax.php'</span> ) ),
      <span class="hljs-string">'nonce'</span>                =&gt; wp_create_nonce( <span class="hljs-string">'carousel_nonce'</span> ),
      <span class="hljs-string">'display_exif'</span>         =&gt; <span class="hljs-keyword">true</span>,
      <span class="hljs-string">'display_geo'</span>          =&gt; <span class="hljs-keyword">false</span>,
      <span class="hljs-string">'background_color'</span>     =&gt; <span class="hljs-string">'white'</span>,
      <span class="hljs-string">'download_original'</span>    =&gt; sprintf( __( <span class="hljs-string">'View full size &lt;span class="photo-size"&gt;%1$s&lt;span class="photo-size-times"&gt;&amp;times;&lt;/span&gt;%2$s&lt;/span&gt;'</span>, <span class="hljs-string">'jetpack'</span> ), <span class="hljs-string">'{0}'</span>, <span class="hljs-string">'{1}'</span> ),
      <span class="hljs-string">'camera'</span>               =&gt; __( <span class="hljs-string">'Camera'</span>, <span class="hljs-string">'jetpack'</span> ),
      <span class="hljs-string">'aperture'</span>             =&gt; __( <span class="hljs-string">'Aperture'</span>, <span class="hljs-string">'jetpack'</span> ),
      <span class="hljs-string">'shutter_speed'</span>        =&gt; __( <span class="hljs-string">'Shutter Speed'</span>, <span class="hljs-string">'jetpack'</span> ),
      <span class="hljs-string">'focal_length'</span>         =&gt; __( <span class="hljs-string">'Focal Length'</span>, <span class="hljs-string">'jetpack'</span> ),
      <span class="hljs-string">'require_name_email'</span>   =&gt; <span class="hljs-variable">$require_name_email</span>,
      <span class="hljs-string">'login_url'</span>            =&gt; wp_login_url( apply_filters( <span class="hljs-string">'the_permalink'</span>, get_permalink() ) ),
    );

    <span class="hljs-variable">$localize_strings</span> = apply_filters( <span class="hljs-string">'jp_carousel_localize_strings'</span>, <span class="hljs-variable">$localize_strings</span> );
    wp_localize_script( <span class="hljs-string">'site'</span>, <span class="hljs-string">'jetpackCarouselStrings'</span>, <span class="hljs-variable">$localize_strings</span> );</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>global $is<em>IE;
if( $is<em>IE )
{
  $msie = strpos( $_SERVER[‘HTTP_USER_AGENT’], ‘MSIE’ ) + 4;
  $version = (float) substr( $_SERVER[‘HTTP_USER_AGENT’], $msie, strpos( $_SERVER[‘HTTP_USER_AGENT’], ‘;’, $msie ) - $msie );
  if( $version &lt; 9 )
    wp_enqueue_style( ‘jetpack-carousel-ie8fix’, plugins_url( ‘jetpack-carousel-ie8fix.css’, __FILE</em></em> ), array(), $this-&gt;asset_version( ‘20121024’ ) );
}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
    do_action( <span class="hljs-string">'jp_carousel_enqueue_assets'</span>, <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;first_run</span>, <span class="hljs-variable">$localize_strings</span> );

    <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;first_run</span> = <span class="hljs-keyword">false</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add_data_to_images</span><span class="hljs-params">( <span class="hljs-variable">$attr</span>, <span class="hljs-variable">$attachment</span> = null )</span>
  </span>{

    <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$this</span><span class="hljs-variable">-&gt;first_run</span> ) <span class="hljs-comment">// not in a gallery</span>
      <span class="hljs-keyword">return</span> <span class="hljs-variable">$attr</span>;

    <span class="hljs-variable">$attachment_id</span>   = intval( <span class="hljs-variable">$attachment</span><span class="hljs-variable">-&gt;ID</span> );
    <span class="hljs-variable">$orig_file</span>       = wp_get_attachment_image_src( <span class="hljs-variable">$attachment_id</span>, <span class="hljs-string">'original'</span> );
    <span class="hljs-variable">$orig_file</span>       = <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$orig_file</span>[<span class="hljs-number">0</span>] ) ? <span class="hljs-variable">$orig_file</span>[<span class="hljs-number">0</span>] : wp_get_attachment_url( <span class="hljs-variable">$attachment_id</span> );
    <span class="hljs-variable">$meta</span>            = wp_get_attachment_metadata( <span class="hljs-variable">$attachment_id</span> );
    <span class="hljs-variable">$size</span>            = <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$meta</span>[<span class="hljs-string">'width'</span>] ) ? intval( <span class="hljs-variable">$meta</span>[<span class="hljs-string">'width'</span>] ) . <span class="hljs-string">','</span> . intval( <span class="hljs-variable">$meta</span>[<span class="hljs-string">'height'</span>] ) : <span class="hljs-string">''</span>;
    <span class="hljs-variable">$img_meta</span>        = ( ! <span class="hljs-keyword">empty</span>( <span class="hljs-variable">$meta</span>[<span class="hljs-string">'image_meta'</span>] ) ) ? (<span class="hljs-keyword">array</span>) <span class="hljs-variable">$meta</span>[<span class="hljs-string">'image_meta'</span>] : <span class="hljs-keyword">array</span>();
    <span class="hljs-variable">$comments_opened</span> = intval( comments_open( <span class="hljs-variable">$attachment_id</span> ) );

    <span class="hljs-variable">$medium_file_info</span> = wp_get_attachment_image_src( <span class="hljs-variable">$attachment_id</span>, <span class="hljs-string">'medium'</span> );
    <span class="hljs-variable">$medium_file</span>      = <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$medium_file_info</span>[<span class="hljs-number">0</span>] ) ? <span class="hljs-variable">$medium_file_info</span>[<span class="hljs-number">0</span>] : <span class="hljs-string">''</span>;

    <span class="hljs-variable">$large_file_info</span>  = wp_get_attachment_image_src( <span class="hljs-variable">$attachment_id</span>, <span class="hljs-string">'large'</span> );
    <span class="hljs-variable">$large_file</span>       = <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$large_file_info</span>[<span class="hljs-number">0</span>] ) ? <span class="hljs-variable">$large_file_info</span>[<span class="hljs-number">0</span>] : <span class="hljs-string">''</span>;

    <span class="hljs-variable">$attachment</span>       = get_post( <span class="hljs-variable">$attachment_id</span> );
    <span class="hljs-variable">$attachment_title</span> = wptexturize( <span class="hljs-variable">$attachment</span><span class="hljs-variable">-&gt;post_title</span> );
    <span class="hljs-variable">$attachment_desc</span>  = wpautop( wptexturize( <span class="hljs-variable">$attachment</span><span class="hljs-variable">-&gt;post_content</span> ) );</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Not yet providing geo-data, need to “fuzzify” for privacy</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> ( ! <span class="hljs-keyword">empty</span>( <span class="hljs-variable">$img_meta</span> ) ) {
      <span class="hljs-keyword">foreach</span> ( <span class="hljs-variable">$img_meta</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$k</span> =&gt; <span class="hljs-variable">$v</span> ) {
        <span class="hljs-keyword">if</span> ( <span class="hljs-string">'latitude'</span> == <span class="hljs-variable">$k</span> || <span class="hljs-string">'longitude'</span> == <span class="hljs-variable">$k</span> )
          <span class="hljs-keyword">unset</span>( <span class="hljs-variable">$img_meta</span>[<span class="hljs-variable">$k</span>] );
      }
    }

    <span class="hljs-variable">$img_meta</span> = json_encode( array_map( <span class="hljs-string">'strval'</span>, <span class="hljs-variable">$img_meta</span> ) );

    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-attachment-id'</span>]     = <span class="hljs-variable">$attachment_id</span>;
    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-orig-file'</span>]         = esc_attr( <span class="hljs-variable">$orig_file</span> );
    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-orig-size'</span>]         = <span class="hljs-variable">$size</span>;
    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-comments-opened'</span>]   = <span class="hljs-keyword">false</span>; <span class="hljs-comment">//$comments_opened;</span>
    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-image-meta'</span>]        = esc_attr( <span class="hljs-variable">$img_meta</span> );
    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-image-title'</span>]       = esc_attr( <span class="hljs-variable">$attachment_title</span> );
    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-image-description'</span>] = esc_attr( <span class="hljs-variable">$attachment_desc</span> );
    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-medium-file'</span>]       = esc_attr( <span class="hljs-variable">$medium_file</span> );
    <span class="hljs-variable">$attr</span>[<span class="hljs-string">'data-large-file'</span>]        = esc_attr( <span class="hljs-variable">$large_file</span> );

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$attr</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add_data_to_container</span><span class="hljs-params">( <span class="hljs-variable">$html</span> )</span>
  </span>{
    <span class="hljs-keyword">global</span> <span class="hljs-variable">$post</span>;

    <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$post</span> ) )
    {
      <span class="hljs-variable">$blog_id</span> = (int) get_current_blog_id();

      <span class="hljs-variable">$extra_data</span> = <span class="hljs-keyword">array</span>(
        <span class="hljs-string">'data-carousel-extra'</span> =&gt; <span class="hljs-keyword">array</span>(
          <span class="hljs-string">'blog_id'</span> =&gt; <span class="hljs-variable">$blog_id</span>,
          <span class="hljs-string">'permalink'</span> =&gt; get_permalink( <span class="hljs-variable">$post</span><span class="hljs-variable">-&gt;ID</span> )
          )
        );

      <span class="hljs-variable">$extra_data</span> = apply_filters( <span class="hljs-string">'jp_carousel_add_data_to_container'</span>, <span class="hljs-variable">$extra_data</span> );

      <span class="hljs-keyword">foreach</span> ( (<span class="hljs-keyword">array</span>) <span class="hljs-variable">$extra_data</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$data_key</span> =&gt; <span class="hljs-variable">$data_values</span> )
      {
        <span class="hljs-variable">$html</span> = str_replace( <span class="hljs-string">'&lt;div '</span>, <span class="hljs-string">'&lt;div '</span> . esc_attr( <span class="hljs-variable">$data_key</span> ) . <span class="hljs-string">"='"</span> . json_encode( <span class="hljs-variable">$data_values</span> ) . <span class="hljs-string">"' "</span>, <span class="hljs-variable">$html</span> );
      }

    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$html</span>;
  }

}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
