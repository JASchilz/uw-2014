<!DOCTYPE html>

<html>
<head>
  <title>class.uw-single-image.php</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="404.html">
                404.php
              </a>
            
              
              <a class="source" href="application.html">
                application.php
              </a>
            
              
              <a class="source" href="archive.html">
                archive.php
              </a>
            
              
              <a class="source" href="breadcrumbs.html">
                breadcrumbs.php
              </a>
            
              
              <a class="source" href="comments.html">
                comments.php
              </a>
            
              
              <a class="source" href="content-archive.html">
                content-archive.php
              </a>
            
              
              <a class="source" href="content-image.html">
                content-image.php
              </a>
            
              
              <a class="source" href="content-page.html">
                content-page.php
              </a>
            
              
              <a class="source" href="content-pdf.html">
                content-pdf.php
              </a>
            
              
              <a class="source" href="content.html">
                content.php
              </a>
            
              
              <a class="source" href="footer.html">
                footer.php
              </a>
            
              
              <a class="source" href="functions.html">
                functions.php
              </a>
            
              
              <a class="source" href="header-image.html">
                header-image.php
              </a>
            
              
              <a class="source" href="header.html">
                header.php
              </a>
            
              
              <a class="source" href="image.html">
                image.php
              </a>
            
              
              <a class="source" href="template-functions.html">
                template-functions.php
              </a>
            
              
              <a class="source" href="index.html">
                index.php
              </a>
            
              
              <a class="source" href="uw.html">
                uw.js
              </a>
            
              
              <a class="source" href="menu-mobile.html">
                menu-mobile.php
              </a>
            
              
              <a class="source" href="page.html">
                page.php
              </a>
            
              
              <a class="source" href="search.html">
                search.php
              </a>
            
              
              <a class="source" href="searchform.html">
                searchform.php
              </a>
            
              
              <a class="source" href="class.button-shortcode.html">
                class.button-shortcode.php
              </a>
            
              
              <a class="source" href="class.dropdowns_walker.html">
                class.dropdowns_walker.php
              </a>
            
              
              <a class="source" href="class.filters.html">
                class.filters.php
              </a>
            
              
              <a class="source" href="class.googleapps.html">
                class.googleapps.php
              </a>
            
              
              <a class="source" href="class.images.html">
                class.images.php
              </a>
            
              
              <a class="source" href="class.install.html">
                class.install.php
              </a>
            
              
              <a class="source" href="class.mimes.html">
                class.mimes.php
              </a>
            
              
              <a class="source" href="class.squish_bugs.html">
                class.squish_bugs.php
              </a>
            
              
              <a class="source" href="class.tile-box-shortcode.html">
                class.tile-box-shortcode.php
              </a>
            
              
              <a class="source" href="class.trumba-shortcode.html">
                class.trumba-shortcode.php
              </a>
            
              
              <a class="source" href="class.users.html">
                class.users.php
              </a>
            
              
              <a class="source" href="class.uw-carousel.html">
                class.uw-carousel.php
              </a>
            
              
              <a class="source" href="class.uw-directory.html">
                class.uw-directory.php
              </a>
            
              
              <a class="source" href="class.uw-documentation.html">
                class.uw-documentation.php
              </a>
            
              
              <a class="source" href="class.uw-dropdowns.html">
                class.uw-dropdowns.php
              </a>
            
              
              <a class="source" href="class.uw-enclosure.html">
                class.uw-enclosure.php
              </a>
            
              
              <a class="source" href="class.uw-iframes.html">
                class.uw-iframes.php
              </a>
            
              
              <a class="source" href="class.uw-media-caption.html">
                class.uw-media-caption.php
              </a>
            
              
              <a class="source" href="class.uw-media-credit.html">
                class.uw-media-credit.php
              </a>
            
              
              <a class="source" href="class.uw-oembeds.html">
                class.uw-oembeds.php
              </a>
            
              
              <a class="source" href="class.uw-page-attributes-meta-box.html">
                class.uw-page-attributes-meta-box.php
              </a>
            
              
              <a class="source" href="class.uw-quicklinks.html">
                class.uw-quicklinks.php
              </a>
            
              
              <a class="source" href="class.uw-replace-media.html">
                class.uw-replace-media.php
              </a>
            
              
              <a class="source" href="class.uw-scripts.html">
                class.uw-scripts.php
              </a>
            
              
              <a class="source" href="class.uw-shortcodes.html">
                class.uw-shortcodes.php
              </a>
            
              
              <a class="source" href="class.uw-styles.html">
                class.uw-styles.php
              </a>
            
              
              <a class="source" href="class.uw-tinymce.html">
                class.uw-tinymce.php
              </a>
            
              
              <a class="source" href="class.uw.html">
                class.uw.php
              </a>
            
              
              <a class="source" href="class.youtube-shortcode.html">
                class.youtube-shortcode.php
              </a>
            
              
              <a class="source" href="sidebar.html">
                sidebar.php
              </a>
            
              
              <a class="source" href="template-big-hero.html">
                template-big-hero.php
              </a>
            
              
              <a class="source" href="template-no-hero.html">
                template-no-hero.php
              </a>
            
              
              <a class="source" href="template-no-sidebar.html">
                template-no-sidebar.php
              </a>
            
              
              <a class="source" href="template-no-title.html">
                template-no-title.php
              </a>
            
              
              <a class="source" href="template-small-hero.html">
                template-small-hero.php
              </a>
            
              
              <a class="source" href="thinstrip.html">
                thinstrip.php
              </a>
            
              
              <a class="source" href="class.uw-blogroll.html">
                class.uw-blogroll.php
              </a>
            
              
              <a class="source" href="class.uw-campus-map.html">
                class.uw-campus-map.php
              </a>
            
              
              <a class="source" href="class.uw-intro.html">
                class.uw-intro.php
              </a>
            
              
              <a class="source" href="class.uw-recent-posts.html">
                class.uw-recent-posts.php
              </a>
            
              
              <a class="source" href="class.uw-related-posts.html">
                class.uw-related-posts.php
              </a>
            
              
              <a class="source" href="class.uw-rss.html">
                class.uw-rss.php
              </a>
            
              
              <a class="source" href="class.uw-sidebar.html">
                class.uw-sidebar.php
              </a>
            
              
              <a class="source" href="class.uw-single-image.html">
                class.uw-single-image.php
              </a>
            
              
              <a class="source" href="class.uw-top-posts.html">
                class.uw-top-posts.php
              </a>
            
              
              <a class="source" href="class.uw-twitter.html">
                class.uw-twitter.php
              </a>
            
              
              <a class="source" href="class.uw-widget-visibility.html">
                class.uw-widget-visibility.php
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>class.uw-single-image.php</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>&lt;?php

/**
 *
 * Single image widget
 *
 * Text paragraph and a single image are displayed
 */

class UW_Widget_Single_Image extends WP_Widget
{

  const DEFAULT_LINK_TEXT = 'More';

  function UW_Widget_Single_Image()
  {
		parent::WP_Widget( $id = 'pic-text', $name = 'Single Image', $options = array( 'description' =&gt; 'Display an image with some featured text.', 'classname' =&gt; 'pic-text-widget' ) );

    if ( is_admin() )
      add_action('admin_enqueue_scripts', array( __CLASS__, 'scripts') );
  }

  function scripts()
  {
    wp_enqueue_script( 'single-image',  get_bloginfo('template_directory') . '/assets/admin/js/widgets/uw.single-image-widget.js' );
    wp_enqueue_script( 'jquery-ui-autocomplete' );
    wp_enqueue_media();
  }

  function form( $instance )
  {

    $title = isset($instance['title']) ? esc_attr($instance['title']) : 'Image Widget';
    $text  = isset($instance['text'])  ? esc_attr($instance['text'])  : '';
    $image = isset($instance['image']) ? esc_attr($instance['image']) : '';
    $src   = isset($instance['src']) ? esc_attr($instance['src']) : '';
    $link  = isset($instance['link']) ? esc_attr($instance['link']) : '';
    $linktext  = isset($instance['link-text']) ? esc_attr($instance['link-text']) : 'Read more';

    ?&gt;

		&lt;p&gt;
		&lt;label for="&lt;?php echo $this-&gt;get_field_id( 'title' ); ?&gt;"&gt;&lt;?php _e( 'Title:' ); ?&gt;  &lt;small&gt;&lt;b&gt;(Search and autofill by typing a title)&lt;/b&gt;&lt;/small&gt;&lt;/label&gt;
		&lt;input data-posttype="post" class="widefat wp-get-posts" id="&lt;?php echo $this-&gt;get_field_id( 'title' ); ?&gt;" name="&lt;?php echo $this-&gt;get_field_name( 'title' ); ?&gt;" type="text" value="&lt;?php echo esc_attr( $title ); ?&gt;" /&gt;
		&lt;/p&gt;

    &lt;p&gt;
      &lt;div class="image-preview wp-get-posts-image-preview" style="width:33%; display:block;"&gt;
        &lt;img src="&lt;?php echo wp_get_attachment_url( $image ); ?&gt;" width="100%" class="wp-get-posts-image" /&gt;
      &lt;/div&gt;

      &lt;a class="select-an-image button" href="#"&gt;Select an Image&lt;/a&gt;
      &lt;input id="&lt;?php echo $this-&gt;get_field_id( 'image' ); ?&gt;" class="wp-get-posts-imageID" name="&lt;?php echo $this-&gt;get_field_name( 'image' ); ?&gt;" type="hidden" value="&lt;?php echo esc_attr( $image ); ?&gt;"/&gt;
      &lt;input id="&lt;?php echo $this-&gt;get_field_id( 'src' ); ?&gt;" class="wp-get-posts-image site-panels-image-fix" name="&lt;?php echo $this-&gt;get_field_name( 'src' ); ?&gt;" type="hidden" value="&lt;?php echo esc_attr( $src ); ?&gt;"/&gt;
    &lt;/p&gt;

		&lt;p&gt;
		&lt;label for="&lt;?php echo $this-&gt;get_field_id( 'text' ); ?&gt;"&gt;&lt;?php _e( 'Featured text:' ); ?&gt;&lt;/label&gt;
		&lt;textarea class="widefat wp-get-posts-excerpt" style="resize:vertical" rows="5" cols="20" id="&lt;?php echo $this-&gt;get_field_id('text'); ?&gt;" name="&lt;?php echo $this-&gt;get_field_name('text'); ?&gt;"&gt;&lt;?php echo esc_textarea( empty($instance['text']) ? '' : $instance['text'] ); ?&gt;&lt;/textarea&gt;
		&lt;/p&gt;

    &lt;p&gt;
    &lt;label for="&lt;?php echo $this-&gt;get_field_id('link'); ?&gt;"&gt;&lt;?php _e('Link:'); ?&gt;&lt;/label&gt;
    &lt;input id="single-image-link-&lt;?php echo $this-&gt;id ?&gt;" class="widefat  wp-get-posts-url" id="&lt;?php echo $this-&gt;get_field_id('link'); ?&gt;" name="&lt;?php echo $this-&gt;get_field_name('link'); ?&gt;" type="text" value="&lt;?php echo $link; ?&gt;" /&gt;
    &lt;/p&gt;

    &lt;p&gt;
    &lt;label for="&lt;?php echo $this-&gt;get_field_id('link-text'); ?&gt;"&gt;&lt;?php _e('Link text:'); ?&gt;&lt;/label&gt;
    &lt;input id="single-image-link-text-&lt;?php echo $this-&gt;id ?&gt;" class="widefat" id="&lt;?php echo $this-&gt;get_field_id('link-text'); ?&gt;" name="&lt;?php echo $this-&gt;get_field_name('link-text'); ?&gt;" type="text" value="&lt;?php echo $linktext; ?&gt;" /&gt;
    &lt;/p&gt;

  &lt;?php

  }

  function update($new_instance, $old_instance)
  {
		$instance['title'] = strip_tags( $new_instance['title'] );
		$instance['text']  = strip_tags( $new_instance['text'] );
		$instance['image'] = (Int) $new_instance['image'];
		$instance['src']   = strip_tags( $new_instance['src'] );
		$instance['link']  = strip_tags( $new_instance['link'] );
		$instance['link-text']  = strip_tags( $new_instance['link-text'] );
    return $instance;
  }

  function widget($args, $instance)
  {

	extract( $args );
	$title = $instance['title'];
    $text  = $instance['text'];
    $image = $instance['image'];
    $link  = $instance['link'];
    $linktext  = isset($instance['link-text']) ? $instance['link-text'] : self::DEFAULT_LINK_TEXT;
    ?&gt;

    &lt;?php  echo $before_widget; ?&gt;

      &lt;?php echo wp_get_attachment_image( $image, 'single-image-widget', false, array('alt' =&gt; $title)); ?&gt;

      &lt;span&gt;

      &lt;?php if ( ! empty( $link) ) : ?&gt;
      &lt;h3&gt;&lt;a href="&lt;?php echo $link; ?&gt;" class="pic-title"&gt;
      &lt;?php endif; ?&gt;

          &lt;?php echo $title; ?&gt;

      &lt;?php if ( ! empty( $link) ) : ?&gt;
        &lt;/a&gt;&lt;/h3&gt;
      &lt;?php endif; ?&gt;

      &lt;?php echo wpautop($text); ?&gt;

      &lt;?php if ( ! empty( $link) ) : ?&gt;
        &lt;a href="&lt;?php echo $link; ?&gt;" class="pic-text-more"&gt;&lt;?php echo $linktext; ?&gt;&lt;/a&gt;
      &lt;?php else: ?&gt;
        &lt;br/&gt;
      &lt;?php endif; ?&gt;
      &lt;/span&gt;
    &lt;?php echo $after_widget;

  }
}

register_widget( 'UW_Widget_Single_Image' );</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
